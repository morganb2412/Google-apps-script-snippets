<!doctype html>
<html>
  <head>
    <base target="_top">
    <meta charset="utf-8">
    <title>Shared Drive Provisioner</title>
    <style>
      body {
        font: 15px/1.6 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        background: #f5f6fa;
        margin: 0;
        padding: 40px;
        color: #333;
      }
      .container {
        max-width: 600px;
        margin: auto;
        background: #fff;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(0,0,0,.08);
      }
      h2 {
        margin-top: 0;
        color: #2d3748;
        font-size: 22px;
      }
      p {
        color: #555;
        font-size: 14px;
      }
      label {
        font-weight: 600;
        display: block;
        margin-top: 16px;
        color: #444;
      }
      input {
        width: 100%;
        padding: 10px 12px;
        margin-top: 6px;
        border: 1px solid #ccc;
        border-radius: 8px;
        font-size: 14px;
      }
      button {
        margin-top: 20px;
        padding: 12px 18px;
        font-size: 15px;
        font-weight: 600;
        color: #fff;
        background: #4f46e5;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.2s ease;
      }
      button:hover {
        background: #4338ca;
      }
      #status {
        margin-top: 18px;
        font-size: 14px;
        font-weight: 500;
        color: #2d3748;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>ATLAS Shared Drive Provisioner</h2>
      <p>
        Enter a Google Sheet URL or ID. The sheet must have a header row with:<br>
        <b>Drive name, Manager, Content Manager, Contributor, Commenter, Viewer</b>.
      </p>

      <label for="sheetRef">Spreadsheet URL or ID</label>
      <input id="sheetRef" type="text" placeholder="https://docs.google.com/spreadsheets/d/... or 1AbCDeFg..." />

      <label for="sheetName">Sheet name (optional)</label>
      <input id="sheetName" type="text" placeholder="e.g. Provisioning" />

      <label for="email">Report recipient (optional, defaults to you)</label>
      <input id="email" type="email" placeholder="name@company.com" />

      <button onclick="run()">Run Provisioning</button>
      <p id="status"></p>
    </div>

    <script>
      function run(){
        document.getElementById('status').textContent = 'Runningâ€¦ please wait.';
        const ref = document.getElementById('sheetRef').value;
        const name = document.getElementById('sheetName').value;
        const email = document.getElementById('email').value;
        google.script.run
          .withSuccessHandler(msg => {
            document.getElementById('status').textContent = msg;
          })
          .withFailureHandler(err => {
            document.getElementById('status').textContent = 'Error: ' + (err.message||err);
          })
          .runProvision(ref, name, email);
      }
    </script>
  </body>
</html>
